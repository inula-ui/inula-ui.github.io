import{o as c,u as mt,a as bt,b as vt,f as gt,y as St,c as yt,g as xt,d as _e,l as x,A as wt,K as Et,L as le,M as It,i as kt,R as Ce,W as ne,N as Ne,k as Rt,n as Dt,p as he,m as A,j as n,t as Ct,e as G,I as K,O as Nt,P as Mt,F as Lt,v as Me,Q as Pt,q as Wt,U as me,H as zt}from"./index-d0d96015.js";import{u as At}from"./useForkRef-acd1f81c.js";import{S as Tt}from"./cancel-53614712.js";import{S as $t}from"./add-ee40325e.js";import{S as Ft}from"./keyboard_arrow_down-84ae58a9.js";import{S as Ot}from"./search-9e5ee1d9.js";import{i as Vt}from"./isPrintableCharacter-1b5c27a6.js";import{T as Le}from"./Tag-424453a7.js";import{V as Ut}from"./VirtualScroll-5de8eeef.js";import{C as Ht}from"./Checkbox-c1a8161a.js";import{E as Pe}from"./Empty-2d2bb020.js";const jt={select:"^select","select.is-expanded":"is-expanded","select.is-disabled":"is-disabled","select--small":"^select--small","select--medium":"^select--medium","select--large":"^select--large",select__container:"^select__container",select__content:"^select__content",select__search:"^select__search","select__placeholder-wrapper":"^select__placeholder-wrapper",select__placeholder:"^select__placeholder","select__multiple-count":"^select__multiple-count",select__close:"^select__close",select__clear:"^select__clear",select__icon:"^select__icon",select__arrow:"^select__arrow","select-popup":"^select-popup","select-popup__content":"^select-popup__content","select-popup__loading":"^select-popup__loading","select-popup__loading--empty":"^select-popup__loading--empty",select__list:"^select__list",select__option:"^select__option","select__option.is-selected":"is-selected","select__option.is-disabled":"is-disabled","select__option-prefix":"^select__option-prefix","select__option-content":"^select__option-content","select__option-group":"^select__option-group","select__option-group-label":"^select__option-group-label",select__empty:"^select__empty"},T=Symbol();function Bt(We,ze){const{styleOverrides:Ae,styleProvider:N,formControl:_,list:M,model:Te,defaultModel:$e,visible:Fe,defaultVisible:Oe,placeholder:be,multiple:r=!1,searchable:w=!1,searchValue:Ve,defaultSearchValue:Ue,clearable:He=!1,loading:q=!1,size:je,disabled:Be=!1,monospaced:Ge=!0,virtual:$=!1,escClosable:Ke=!0,customItem:ve,customSelected:L,customSearch:E,createItem:oe,inputRef:qe,inputRender:ge,popupRender:Se,onModelChange:ie,onVisibleChange:Ye,onSearch:Je,onClear:ce,onCreateItem:ae,onScrollBottom:Qe,afterVisibleChange:P,...u}=mt("Select",We),W=bt(),i=vt(jt,{select:N==null?void 0:N.select,"select-popup":N==null?void 0:N["select-popup"]},Ae),g=gt(),{t:Y}=St(),ye=yt(),xe=`${W}-select-list-${ye}`,F=e=>`${W}-select-item-${e}-${ye}`,{pageScrollRef:Ze,contentResizeRef:Xe}=xt(),I=c.useRef(null),h=c.useRef(null),k=c.useRef(null),J=c.useRef(null),et=At(J,qe),O=c.useRef(null),V=c.useMemo(()=>{const e=new Map,t=s=>{for(const l of s)e.set(l.value,l),l.children&&t(l.children)};return t(M),e},[M]),[a,S]=_e(Oe??!1,Fe,Ye),[U,tt]=_e(Ue??"",Ve,Je),R=c.useCallback(e=>!e.disabled&&!e.children,[]),[Q,Z]=_e($e??(r?[]:null),Te,e=>{ie&&(r?ie(e,e.map(t=>V.get(t))):ie(e,x.isNull(e)?null:V.get(e)))},void 0,_==null?void 0:_.control),v=c.useMemo(()=>r?new Set(Q):Q,[Q,r]),X=e=>{r?Z(t=>{const s=t.findIndex(l=>l===e);s!==-1?t.splice(s,1):t.push(e)}):(Z(e),S(!1))},{size:re,disabled:z}=wt({size:je,disabled:Be||(_==null?void 0:_.control.disabled)}),H=U.length>0,de=r?v.size>0:!x.isNull(v),ue=(()=>{if(!H)return[];const e=x.isUndefined(E==null?void 0:E.filter)?o=>o.label.includes(U):o=>E.filter(U,o),t=E==null?void 0:E.sort;let s=oe==null?void 0:oe(U);s&&(s={...s,[T]:!0});let l=[];return M.forEach(o=>{if(!o.children)s&&o.value===s.value&&(s=void 0),e(o)&&l.push(o);else{const d=[];o.children.forEach(m=>{s&&m.value===s.value&&(s=void 0),e(m)&&d.push(m)}),l=l.concat(d)}}),t&&l.sort(t),s&&l.unshift(s),l})(),j=H?ue:M,[st,lt]=Et(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[we,nt]=c.useState(),ot=(()=>{let e;return we&&(e=V.get(we.value),e&&R(e))||(de&&(e=le(M,t=>R(t)&&r?v.has(t.value):v===t.value)),x.isUndefined(e)&&(e=le(M,t=>R(t)))),e})(),[pe,it]=c.useState(),ct=(()=>{if(pe&&le(ue,e=>R(e)&&e.value===pe.value))return pe;if(H)return le(ue,e=>R(e))})(),p=H?ct:ot,Ee=e=>{H?it(e):nt(e)},Ie=e=>{if(!x.isUndefined(e)){const t=Object.assign({},e);delete t[T],ae==null||ae(t)}},at=It(a),rt=`calc(var(--${W}-zindex-fixed) + ${at})`,ee=c.useRef(),y=kt(()=>{if(a&&I.current&&h.current)if(Ge){const e=Math.min(I.current.offsetWidth,Ce.windowSize.width-ne*2),t=h.current.offsetHeight,s=Ne(I.current,{width:e,height:t},{placement:"bottom",inWindow:ne});ee.current=s.transformOrigin,g.classes.position&&h.current.classList.toggle(g.classes.position,!1),g.replaceRule("position",{top:s.top,left:s.left,width:e}),h.current.classList.toggle(g.classes.position,!0)}else{const e=I.current.offsetWidth,t=h.current.offsetHeight,s=Ce.windowSize.width-ne*2,l=Math.min(Math.max(h.current.scrollWidth,e),s),o=Ne(I.current,{width:l,height:t},{placement:"bottom-left",inWindow:ne});ee.current=o.transformOrigin,g.classes.position&&h.current.classList.toggle(g.classes.position,!1),g.replaceRule("position",{top:o.top,left:o.left,minWidth:Math.min(e,s),maxWidth:s}),h.current.classList.toggle(g.classes.position,!0)}}),dt=Rt(y,!a);Dt(Ze,"scroll",y,{passive:!0},!a||dt),he(I,y,void 0,!a),he(h,y,void 0,!a),he(Xe,y,void 0,!a),c.useImperativeHandle(ze,()=>({updatePosition:y}),[y]);const te=e=>{document.activeElement===J.current&&e.target!==J.current&&e.button===0&&e.preventDefault()},D=c.useRef(),se=w&&a,ke=He&&de&&!a&&!q&&!z,Re=lt(c.createElement(w?"input":"div",Object.assign({...A(i("select__search"),{style:{opacity:se?void 0:0,zIndex:se?void 0:-1}}),..._==null?void 0:_.inputAria,ref:et,tabIndex:z?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":a,"aria-controls":xe,onBlur:()=>{S(!1)},onKeyDown:e=>{if(e.code==="Escape")a&&Ke&&(e.stopPropagation(),e.preventDefault(),S(!1));else{const t=s=>{var l,o,d,m;if(k.current){let f;switch(s){case"next":f=(l=O.current)==null?void 0:l.scrollToStep(k.current,1);break;case"prev":f=(o=O.current)==null?void 0:o.scrollToStep(k.current,-1);break;case"first":f=(d=O.current)==null?void 0:d.scrollToStart(k.current);break;case"last":f=(m=O.current)==null?void 0:m.scrollToEnd(k.current);break}f&&(Ee(f),$===!1&&(D.current=()=>{const C=document.getElementById(F(f.value));C&&zt(C,k.current)},a&&(D.current(),D.current=void 0)))}};if(a)switch(e.code){case"ArrowUp":{e.preventDefault(),t("prev");break}case"ArrowDown":{e.preventDefault(),t("next");break}case"Home":{e.preventDefault(),t("first");break}case"End":{e.preventDefault(),t("last");break}default:{(e.code==="Enter"||e.code==="Space"&&!w)&&(e.preventDefault(),p&&(p[T]&&Ie(p),X(p.value)));break}}else if(!(w&&["Home","End","Enter","Space"].includes(e.code)))switch(e.code){case"End":case"ArrowUp":{e.preventDefault(),S(!0),t("last");break}case"Home":case"ArrowDown":{e.preventDefault(),S(!0),t("first");break}case"Enter":case"Space":{e.preventDefault(),S(!0);break}default:{Vt(e.key)&&S(!0);break}}}},onChange:e=>{w&&tt(e.currentTarget.value)}},w?{type:"text",value:U,autoComplete:"off",disabled:z}:{}))),[ut,pt,ft]=(()=>{let e=null,t=null,s;if(r){const l=[];for(const o of Q){const d=V.get(o);d&&l.push(d)}t=n(Ct,{list:l.map(o=>{const{label:d,value:m,disabled:f}=o,C=L?L(o):d;return{id:m,title:C,type:"item",disabled:f}}),onClick:o=>(X(o),!1),children:n(Le,{tabIndex:-1,size:re,children:v.size})}),e=l.map(o=>G(Le,{size:re,children:[L?L(o):o.label,!(o.disabled||z)&&n("div",{...i("select__close"),role:"button","aria-label":Y("Close"),onClick:d=>{d.stopPropagation(),X(o.value)},children:n(K,{children:n(Nt,{})})})]},o.value))}else if(!x.isNull(v)){const l=V.get(v);l&&(s=l.label,e=L?L(l):s)}return[e,t,s]})(),_t=Mt({compose:{disabled:z},form:_}),ht=c.useMemo(()=>({list:j,itemKey:e=>e.value,itemSize:x.isNumber($)?$:32,itemEmptySize:32,itemNested:e=>e.children,itemFocusable:R}),[R,j,$]);return G(Lt,{children:[G("div",{...u,...A(i("select",`select--${re}`,{"select.is-expanded":a,"select.is-disabled":z}),{className:u.className,style:u.style}),..._t,ref:I,onMouseDown:e=>{var t;(t=u.onMouseDown)==null||t.call(u,e),te(e)},onMouseUp:e=>{var t;(t=u.onMouseUp)==null||t.call(u,e),te(e)},onClick:e=>{var t,s;(t=u.onClick)==null||t.call(u,e),(s=J.current)==null||s.focus({preventScroll:!0}),S(l=>w?!0:!l)},children:[G("div",{...i("select__container"),title:ft,children:[ge?ge(Re):Re,!se&&(de?n("div",{...i("select__content"),children:ut}):be?n("div",{...i("select__placeholder-wrapper"),children:n("div",{...i("select__placeholder"),children:be})}):null)]}),r&&n("div",{...i("select__multiple-count"),onClick:e=>{e.stopPropagation()},children:pt}),ke&&n("div",{...i("select__clear"),role:"button","aria-label":Y("Clear"),onClick:e=>{e.stopPropagation(),Z(r?[]:null),ce==null||ce()},children:n(K,{children:n(Tt,{})})}),n("div",{...A(i("select__icon"),{style:{visibility:ke?"hidden":void 0}}),children:n(K,{children:q?n(Me,{}):se?n(Ot,{}):n(Ft,{...i("select__arrow")})})})]}),n(Pt,{selector:()=>{let e=document.getElementById(`${W}-select-root`);return e||(e=document.createElement("div"),e.id=`${W}-select-root`,document.body.appendChild(e)),e},children:n(Wt,{enter:a,during:me,afterRender:()=>{var e;y(),(e=D.current)==null||e.call(D),D.current=void 0},afterEnter:()=>{P==null||P(!0)},afterLeave:()=>{P==null||P(!1)},children:e=>{let t={};switch(e){case"enter":t={transform:"scaleY(0.7)",opacity:0};break;case"entering":t={transition:["transform","opacity"].map(s=>`${s} ${me}ms ease-out`).join(", "),transformOrigin:ee.current};break;case"leaving":t={transform:"scaleY(0.7)",opacity:0,transition:["transform","opacity"].map(s=>`${s} ${me}ms ease-in`).join(", "),transformOrigin:ee.current};break;case"leaved":t={display:"none"};break}return n("div",{...A(i("select-popup"),{style:{zIndex:rt,...t}}),ref:h,onMouseDown:s=>{te(s)},onMouseUp:s=>{te(s)},children:(()=>{const s=G("div",{...i("select-popup__content"),children:[q&&n("div",{...i("select-popup__loading",{"select-popup__loading--empty":j.length===0}),children:n(K,{children:n(Me,{})})}),q&&j.length===0?null:n(Ut,{...ht,ref:O,enable:$!==!1,listSize:264,listPadding:4,itemRender:(l,o,d,m,f)=>{const{label:C,value:b,disabled:fe}=l,De=ve?ve(l):C;if(f)return c.createElement("ul",{...i("select__option-group"),key:b,role:"group","aria-labelledby":F(b)},c.createElement("li",{...i("select__option-group-label"),key:b,id:F(b),role:"presentation"},n("div",{...i("select__option-content"),children:De})),f);let B=!1;return r?B=v.has(b):B=v===b,c.createElement("li",{...A(i("select__option",{"select__option.is-selected":!r&&B,"select__option.is-disabled":fe}),{style:{paddingLeft:m.length===0?void 0:20}}),...d,key:b,id:F(b),title:(l[T]?Y("Create")+" ":"")+C,role:"option","aria-selected":B,"aria-disabled":fe,onClick:()=>{l[T]&&Ie(l),Ee(l),X(b)}},st&&(p==null?void 0:p.value)===b&&n("div",{className:`${W}-focus-outline`}),l[T]?n("div",{...i("select__option-prefix"),children:n(K,{theme:"primary",children:n($t,{})})}):r?n("div",{...i("select__option-prefix"),children:n(Ht,{model:B,disabled:fe})}):null,n("div",{...i("select__option-content"),children:De}))},itemFocused:p==null?void 0:p.value,itemEmptyRender:()=>n("li",{...A(i("select__empty"),{style:{paddingLeft:20}}),children:n("div",{...i("select__option-content"),children:Y("No Data")})}),itemInAriaSetsize:l=>!l.children,placeholder:"li",onScrollEnd:Qe,children:(l,o)=>n("ul",{...i("select__list"),ref:k,id:xe,tabIndex:-1,role:"listbox","aria-multiselectable":r,"aria-activedescendant":x.isUndefined(p)?void 0:F(p.value),onScroll:o,children:j.length===0?n(Pe,{style:{padding:"12px 0"},image:Pe.SIMPLE_IMG}):l})})]});return Se?Se(s):s})()})}})})]})}const ls=c.forwardRef(Bt);export{ls as S};
