import{e as n,k as Pe,l as W,H as Ge,f as X,F as Ye,j as c,I as re,v as Me,J as fa,u as _a,a as ha,b as ba,g as ma,y as va,c as ga,h as Sa,d as Re,A as ka,K as ya,L as De,M as Ea,R as wa,W as je,N as xa,n as Ca,o as Ia,p as Ne,m as ve,t as Ra,O as Da,P as Na,Q as Ta,q as Ma,U as Te}from"./index-85e8a7cd.js";import{u as Pa}from"./useForkRef-6c3bcbe6.js";import{S as La}from"./cancel-8a690def.js";import{S as Aa}from"./keyboard_arrow_down-1769d28f.js";import{S as Fa}from"./search-1e7d9ecd.js";import{V as qe}from"./VirtualScroll-254e63ee.js";import{C as Je}from"./Checkbox-68fe0990.js";import{E as Se}from"./Empty-c2f1dcec.js";import{g as ge}from"./utils-c2ed83c6.js";import{T as N,M as Wa,S as Ha}from"./single-node-19c90d0d.js";import{i as za}from"./isPrintableCharacter-1b5c27a6.js";import{T as Be}from"./Tag-6f5084ca.js";function Ua(G,ee){const{namespace:ae,styled:p,id:g,list:w,customItem:$,itemId:K,itemSelected:y,itemFocused:_,multiple:M,virtual:l,focusVisible:R,onFocus:Y,onClick:E,_root:x=!0}=G,m=n.useRef(null),S=n.useRef(null),d=n.useRef(null),P=_&&w.findIndex(a=>a.id===_.id)!==-1,o=(()=>{if(_)for(const a of w){if(_.id===a.id)return a;let f=_;for(;f.parent;)if(f=f.parent,f.id===a.id)return a}})(),h=Pe(a=>{var f,q,H,C,J,te,ie;if(m.current){let k;if(x&&W.isUndefined(_))switch(a){case"first":case"next":k=(f=S.current)==null?void 0:f.scrollToStart(m.current);break;case"last":case"prev":k=(q=S.current)==null?void 0:q.scrollToEnd(m.current);break}else if(P)switch(a){case"next":k=(H=S.current)==null?void 0:H.scrollToStep(m.current,1);break;case"prev":k=(C=S.current)==null?void 0:C.scrollToStep(m.current,-1);break;case"first":k=(J=S.current)==null?void 0:J.scrollToStart(m.current);break;case"last":k=(te=S.current)==null?void 0:te.scrollToEnd(m.current);break;case"prev-level":o&&o.parent&&(k=o.parent);break;case"next-level":if(o&&o.children){for(const L of o.children)if(L.enabled){k=L;break}}break;default:a instanceof HTMLElement&&m.current&&Ge(a,m.current);break}else k=(ie=d.current)==null?void 0:ie.call(d,a);return k}});n.useImperativeHandle(ee,()=>h,[h]);const T=n.useMemo(()=>({list:w,itemKey:a=>a.id,itemSize:W.isNumber(l)?l:32,itemFocusable:a=>a.enabled}),[w,l]);return X(Ye,{children:[c(qe,{...T,ref:S,enable:l!==!1,listSize:264,listPadding:4,itemRender:(a,f,q)=>{let H=!1;if(a.children&&y){let C=y;for(;C.parent;)if(C=C.parent,C.id===a.id){H=!0;break}}return n.createElement("li",{...p("cascader__option",{"cascader__option.is-focused":a.id===(o==null?void 0:o.id),"cascader__option.is-selected":!M&&a.checked,"cascader__option.is-disabled":a.disabled}),...q,key:a.id,id:K(a.id),title:a.origin.label,role:"option","aria-selected":a.checked,"aria-disabled":a.disabled,onClick:()=>{Y(a),M&&!a.isLeaf||E(a)}},R&&(_==null?void 0:_.id)===a.id&&c("div",{className:`${ae}-focus-outline`}),H&&c("div",{...p("cascader__option-dot")}),M&&c("div",{...p("cascader__option-prefix"),children:c(Je,{model:a.checked,disabled:a.disabled,indeterminate:a.indeterminate,onClick:C=>{C.stopPropagation(),Y(a),E(a)}})}),c("div",{...p("cascader__option-content"),children:$?$(a.origin):a.origin.label}),!a.isLeaf&&c("div",{...p("cascader__option-icon"),children:c(re,{children:a.origin.loading?c(Me,{}):c(fa,{})})}))},itemFocused:o==null?void 0:o.id,placeholder:"li",children:(a,f)=>c("ul",{...p("cascader__list","cascader__list--inline"),ref:m,id:g,tabIndex:-1,role:"listbox","aria-multiselectable":M,"aria-activedescendant":x&&!W.isUndefined(_)?K(_.id):void 0,onScroll:f,children:w.length===0?c(Se,{style:{padding:"12px 28px"},image:Se.SIMPLE_IMG}):a})}),o&&!o.origin.loading&&o.children&&c(Qe,{...G,_root:!1,ref:d,id:void 0,list:o.children})]})}const Qe=n.forwardRef(Ua);function $a(G,ee){const{namespace:ae,styled:p,id:g,list:w,customItem:$,itemId:K,itemFocused:y,multiple:_,onlyLeafSelectable:M,virtual:l,focusVisible:R,onClick:Y}=G,E=n.useRef(null),x=n.useRef(null),m=Pe(d=>{var P,o,h,T;if(E.current){let a;switch(d){case"next":a=(P=x.current)==null?void 0:P.scrollToStep(E.current,1);break;case"prev":a=(o=x.current)==null?void 0:o.scrollToStep(E.current,-1);break;case"first":a=(h=x.current)==null?void 0:h.scrollToStart(E.current);break;case"last":a=(T=x.current)==null?void 0:T.scrollToEnd(E.current);break;default:d instanceof HTMLElement&&E.current&&Ge(d,E.current);break}return a}});n.useImperativeHandle(ee,()=>m,[m]);const S=n.useMemo(()=>({list:w,itemKey:d=>d.value,itemSize:W.isNumber(l)?l:32,itemFocusable:d=>d[N].enabled}),[w,l]);return c(qe,{...S,ref:x,enable:l!==!1,listSize:264,listPadding:4,itemRender:(d,P,o)=>{const h=d[N];let T=h.checked;if(!M){let a=h;for(;a.parent;)if(a=a.parent,a.id===d.value){T=!0;break}}return n.createElement("li",{...p("cascader__option",{"cascader__option.is-selected":!_&&T,"cascader__option.is-disabled":h.disabled}),...o,key:d.value,id:K(d.value),title:d.label,role:"option","aria-selected":h.checked,"aria-disabled":h.disabled,onClick:()=>{Y(d)}},R&&(y==null?void 0:y.value)===d.value&&c("div",{className:`${ae}-focus-outline`}),_&&c("div",{...p("cascader__option-prefix"),children:c(Je,{model:h.checked,disabled:h.disabled})}),c("div",{...p("cascader__option-content"),children:$?$(h.origin):ge(h)}))},itemFocused:y==null?void 0:y.value,placeholder:"li",children:(d,P)=>c("ul",{...p("cascader__list"),ref:E,id:g,tabIndex:-1,role:"listbox","aria-multiselectable":_,"aria-activedescendant":W.isUndefined(y)?void 0:K(y.value),onScroll:P,children:w.length===0?c(Se,{style:{padding:"12px 28px"},image:Se.SIMPLE_IMG}):d})})}const Ka=n.forwardRef($a),Va={cascader:"^cascader","cascader.is-expanded":"is-expanded","cascader.is-disabled":"is-disabled","cascader--small":"^cascader--small","cascader--medium":"^cascader--medium","cascader--large":"^cascader--large",cascader__container:"^cascader__container",cascader__content:"^cascader__content",cascader__search:"^cascader__search","cascader__placeholder-wrapper":"^cascader__placeholder-wrapper",cascader__placeholder:"^cascader__placeholder","cascader__multiple-count":"^cascader__multiple-count",cascader__close:"^cascader__close",cascader__clear:"^cascader__clear",cascader__icon:"^cascader__icon",cascader__arrow:"^cascader__arrow","cascader-popup":"^cascader-popup","cascader-popup__content":"^cascader-popup__content","cascader-popup__loading":"^cascader-popup__loading","cascader-popup__loading--empty":"^cascader-popup__loading--empty",cascader__list:"^cascader__list","cascader__list--inline":"^cascader__list--inline",cascader__option:"^cascader__option","cascader__option.is-focused":"is-focused","cascader__option.is-selected":"is-selected","cascader__option.is-disabled":"is-disabled","cascader__option-dot":"^cascader__option-dot","cascader__option-prefix":"^cascader__option-prefix","cascader__option-content":"^cascader__option-content","cascader__option-icon":"^cascader__option-icon",cascader__empty:"^cascader__empty"};function Oa(G,ee){const{styleOverrides:ae,styleProvider:p,formControl:g,list:w,model:$,defaultModel:K,visible:y,defaultVisible:_,placeholder:M,multiple:l=!1,searchable:R=!1,searchValue:Y,defaultSearchValue:E,onlyLeafSelectable:x=!0,clearable:m=!1,loading:S=!1,size:d,disabled:P=!1,virtual:o=!1,escClosable:h=!0,customItem:T,customSelected:a,customSearch:f,inputRef:q,inputRender:H,popupRender:C,onModelChange:J,onVisibleChange:te,onSearch:ie,onClear:k,onFirstFocus:L,afterVisibleChange:Q,...I}=_a("Cascader",G),V=ha(),b=ba(Va,{cascader:p==null?void 0:p.cascader,"cascader-popup":p==null?void 0:p["cascader-popup"]},ae),ne=ma(),{t:Le}=va(),Ae=ga(),ke=`${V}-cascader-list-${Ae}`,ye=e=>`${V}-cascader-item-${e}-${Ae}`,{pageScrollRef:Ze,contentResizeRef:Xe}=Sa(),le=n.useRef(null),O=n.useRef(null),oe=n.useRef(null),ea=Pa(oe,q),ce=n.useRef(null),de=n.useRef({itemFocused:new Set}),[ue,j]=n.useMemo(()=>{const e=w.map(t=>l?new Wa(t,r=>r.value,{disabled:t.disabled}):new Ha(t,r=>r.value,{disabled:t.disabled})),s=new Map,i=t=>{for(const r of t)s.set(r.id,r),r.children&&i(r.children)};return i(e),[e,s]},[w,l]),[v,A]=Re(_??!1,y,te),[pe,aa]=Re(E??"",Y,ie),[fe,z]=Re(K??(l?[]:null),$,e=>{J&&(l?J(e,e.map(s=>j.get(s).origin)):J(e,W.isNull(e)?null:j.get(e).origin))},void 0,g==null?void 0:g.control),D=n.useMemo(()=>l?new Set(fe):fe,[fe,l]),Fe=e=>{if(l){const s=e.changeStatus(e.checked?"UNCHECKED":"CHECKED",D);z(Array.from(s.keys()))}else(e.isLeaf||!x)&&z(e.id),e.isLeaf&&A(!1)},We=e=>{if(l){const s=e[N].changeStatus(e[N].checked?"UNCHECKED":"CHECKED",D);z(Array.from(s.keys()))}else z(e[N].id),A(!1)};j.forEach(e=>{e.updateStatus(D)});const{size:Ee,disabled:Z}=ka({size:d,disabled:P||(g==null?void 0:g.control.disabled)}),F=pe.length>0,_e=l?D.size>0:!W.isNull(D),he=(()=>{if(!F)return[];const e=W.isUndefined(f==null?void 0:f.filter)?r=>r.label.includes(pe):r=>f.filter(pe,r),s=f==null?void 0:f.sort,i=[],t=r=>{r.forEach(u=>{(!l&&!x||u.isLeaf)&&e(u.origin)&&i.push({label:ge(u),value:u.id,disabled:u.disabled,[N]:u}),u.children&&t(u.children)})};return t(ue),s&&i.sort((r,u)=>s(r[N].origin,u[N].origin)),i})(),He=F?he.length===0:ue.length===0,[ze,ca]=ya(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[Ue,sa]=n.useState(),$e=e=>{de.current.itemFocused.has(e.id)||(de.current.itemFocused.add(e.id),L==null||L(e.id,e.origin)),sa(e)},we=(()=>{if(Ue){const e=j.get(Ue.id);if(e&&e.enabled)return e}if(_e)return De(ue,e=>e.enabled&&e.checked)})(),[xe,ra]=n.useState(),Ke=e=>{de.current.itemFocused.has(e.value)||(de.current.itemFocused.add(e.value),L==null||L(e.value,e[N].origin)),ra(e)},Ce=(()=>{if(xe&&De(he,e=>e[N].enabled&&e.value===xe.value))return xe;if(F)return De(he,e=>e[N].enabled)})(),ta=Ea(v),ia=`calc(var(--${V}-zindex-fixed) + ${ta})`,Ie=n.useRef(),U=Pe(()=>{if(v&&le.current&&O.current){const e=O.current.offsetHeight,s=wa.windowSize.width-je*2,i=Math.min(O.current.scrollWidth,s),t=xa(le.current,{width:i,height:e},{placement:"bottom-left",inWindow:je});Ie.current=t.transformOrigin,ne.classes.position&&O.current.classList.toggle(ne.classes.position,!1),ne.replaceRule("position",{top:t.top,left:t.left,maxWidth:s}),O.current.classList.toggle(ne.classes.position,!0)}}),na=Ca(U,!v);Ia(Ze,"scroll",U,{passive:!0},!v||na),Ne(le,U,void 0,!v),Ne(O,U,void 0,!v),Ne(Xe,U,void 0,!v),n.useImperativeHandle(ee,()=>({updatePosition:U}),[U]);const be=e=>{document.activeElement===oe.current&&e.target!==oe.current&&e.button===0&&e.preventDefault()},B=n.useRef(),me=R&&v,Ve=m&&_e&&!v&&!S&&!Z,Oe=ca(n.createElement(R?"input":"div",Object.assign({...ve(b("cascader__search"),{style:{opacity:me?void 0:0,zIndex:me?void 0:-1}}),...g==null?void 0:g.inputAria,ref:ea,tabIndex:Z?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":v,"aria-controls":ke,onBlur:()=>{A(!1)},onKeyDown:e=>{if(e.code==="Escape")v&&h&&(e.stopPropagation(),e.preventDefault(),A(!1));else{const s=i=>{if(ce.current){const t=ce.current(i);t&&(F?Ke(t):$e(t),o===!1&&!i.includes("level")&&(B.current=()=>{const r=document.getElementById(ye(F?t.value:t.id));r&&ce.current(r)},v&&(B.current(),B.current=void 0)))}};if(v)switch(e.code){case"ArrowUp":{e.preventDefault(),s("prev");break}case"ArrowDown":{e.preventDefault(),s("next");break}case"ArrowLeft":{F||(e.preventDefault(),s("prev-level"));break}case"ArrowRight":{F||(e.preventDefault(),s("next-level"));break}case"Home":{e.preventDefault(),s("first");break}case"End":{e.preventDefault(),s("last");break}default:{(e.code==="Enter"||e.code==="Space"&&!R)&&(e.preventDefault(),F?Ce&&We(Ce):we&&Fe(we));break}}else if(!(R&&["Home","End","Enter","Space"].includes(e.code)))switch(e.code){case"End":case"ArrowUp":{e.preventDefault(),A(!0),s("last");break}case"Home":case"ArrowDown":{e.preventDefault(),A(!0),s("first");break}case"Enter":case"Space":{e.preventDefault(),A(!0);break}default:{za(e.key)&&A(!0);break}}}},onChange:e=>{R&&aa(e.currentTarget.value)}},R?{type:"text",value:pe,autoComplete:"off",disabled:Z}:{}))),[la,oa,da]=(()=>{let e=null,s=null,i;if(l){const t=[];for(const r of fe){const u=j.get(r);u&&t.push(u)}s=c(Ra,{list:t.map(r=>{const{value:u,disabled:se}=r.origin,pa=a?a(r.origin):ge(r);return{id:u,title:pa,type:"item",disabled:se,node:r}}),onClick:(r,u)=>{const se=u.node.changeStatus("UNCHECKED",D);return z(Array.from(se.keys())),!1},children:c(Be,{tabIndex:-1,size:Ee,children:D.size})}),e=t.map(r=>X(Be,{size:Ee,children:[a?a(r.origin):r.origin.label,!(r.disabled||Z)&&c("div",{...b("cascader__close"),role:"button","aria-label":Le("Close"),onClick:u=>{u.stopPropagation();const se=r.changeStatus("UNCHECKED",D);z(Array.from(se.keys()))},children:c(re,{children:c(Da,{})})})]},r.id))}else if(!W.isNull(D)){const t=j.get(D);t&&(i=ge(t),e=a?a(t.origin):i)}return[e,s,i]})(),ua=Na({compose:{disabled:Z},form:g});return X(Ye,{children:[X("div",{...I,...ve(b("cascader",`cascader--${Ee}`,{"cascader.is-expanded":v,"cascader.is-disabled":Z}),{className:I.className,style:I.style}),...ua,ref:le,onMouseDown:e=>{var s;(s=I.onMouseDown)==null||s.call(I,e),be(e)},onMouseUp:e=>{var s;(s=I.onMouseUp)==null||s.call(I,e),be(e)},onClick:e=>{var s,i;(s=I.onClick)==null||s.call(I,e),(i=oe.current)==null||i.focus({preventScroll:!0}),A(t=>R?!0:!t)},children:[X("div",{...b("cascader__container"),title:da,children:[H?H(Oe):Oe,!me&&(_e?c("div",{...b("cascader__content"),children:la}):M?c("div",{...b("cascader__placeholder-wrapper"),children:c("div",{...b("cascader__placeholder"),children:M})}):null)]}),l&&c("div",{...b("cascader__multiple-count"),onClick:e=>{e.stopPropagation()},children:oa}),Ve&&c("div",{...b("cascader__clear"),role:"button","aria-label":Le("Clear"),onClick:e=>{e.stopPropagation(),k==null||k(),z(l?[]:null)},children:c(re,{children:c(La,{})})}),c("div",{...ve(b("cascader__icon"),{style:{visibility:Ve?"hidden":void 0}}),children:c(re,{children:S?c(Me,{}):me?c(Fa,{}):c(Aa,{...b("cascader__arrow")})})})]}),c(Ta,{selector:()=>{let e=document.getElementById(`${V}-cascader-root`);return e||(e=document.createElement("div"),e.id=`${V}-cascader-root`,document.body.appendChild(e)),e},children:c(Ma,{enter:v,during:Te,afterRender:()=>{var e;U(),(e=B.current)==null||e.call(B),B.current=void 0},afterEnter:()=>{Q==null||Q(!0)},afterLeave:()=>{Q==null||Q(!1)},children:e=>{let s={};switch(e){case"enter":s={transform:"scaleY(0.7)",opacity:0};break;case"entering":s={transition:["transform","opacity"].map(i=>`${i} ${Te}ms ease-out`).join(", "),transformOrigin:Ie.current};break;case"leaving":s={transform:"scaleY(0.7)",opacity:0,transition:["transform","opacity"].map(i=>`${i} ${Te}ms ease-in`).join(", "),transformOrigin:Ie.current};break;case"leaved":s={display:"none"};break}return c("div",{...ve(b("cascader-popup"),{style:{zIndex:ia,...s}}),ref:O,onMouseDown:i=>{be(i)},onMouseUp:i=>{be(i)},children:(()=>{const i=X("div",{...b("cascader-popup__content"),children:[S&&c("div",{...b("cascader-popup__loading",{"cascader-popup__loading--empty":He}),children:c(re,{children:c(Me,{})})}),S&&He?null:F?c(Ka,{ref:ce,namespace:V,styled:b,id:ke,list:he,customItem:T,itemId:ye,itemFocused:Ce,multiple:l,onlyLeafSelectable:x,virtual:o,focusVisible:ze,onClick:t=>{Ke(t),We(t)}}):c(Qe,{ref:ce,namespace:V,styled:b,id:ke,list:ue,customItem:T,itemId:ye,itemSelected:!l&&_e?j.get(D):void 0,itemFocused:we,multiple:l,virtual:o,focusVisible:ze,onFocus:$e,onClick:Fe})]});return C?C(i):i})()})}})})]})}const sc=n.forwardRef(Oa);export{sc as C};
