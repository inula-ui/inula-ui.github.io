import{u as Z,a as ee,b as se,o as c,c as te,d as _,l as g,z as ne,J as ae,K as F,j as de}from"./index-249b6286.js";import{T as oe}from"./TreePanel-ef02329b.js";import{C as ie,M as ce,S as le}from"./single-node-19c90d0d.js";function pe(P){const{styleOverrides:U,styleProvider:f,formControl:o,list:S,model:V,defaultModel:$,expands:j,defaultExpands:z,showLine:B=!1,multiple:a=!1,onlyLeafSelectable:E=!0,disabled:W=!1,virtual:w,customItem:q,onModelChange:p,onFirstExpand:m,onExpandsChange:k,onScrollBottom:J,...l}=Z("Tree",P),v=ee(),O=se(ie,{tree:f==null?void 0:f.tree},U),u=c.useRef(null),D=c.useRef({expands:new Set}),G=te(),I=e=>`${v}-tree-item-${e}-${G}`,[b,i]=c.useMemo(()=>{const e=S.map(n=>a?new ce(n,t=>t.value,{disabled:n.disabled}):new le(n,t=>t.value,{disabled:n.disabled})),s=new Map,d=n=>{for(const t of n)s.set(t.id,t),t.children&&d(t.children)};return d(e),[e,s]},[S,a]),[h,M]=_($??(a?[]:null),V,e=>{p&&(a?p(e,e.map(s=>i.get(s).origin)):p(e,g.isNull(e)?null:i.get(e).origin))},void 0,o==null?void 0:o.control),r=c.useMemo(()=>a?new Set(h):h,[h,a]);i.forEach(e=>{e.updateStatus(r)});const[N,C]=_(z??[],j,e=>{k&&k(e,e.map(s=>i.get(s).origin))}),y=c.useMemo(()=>new Set(N),[N]),{disabled:A}=ne({disabled:W||(o==null?void 0:o.control.disabled)}),T=a?r.size>0:!g.isNull(r),[Q,X]=ae(e=>e.startsWith("Arrow")||["Home","End","Enter","Space"].includes(e)),[K,L]=c.useState(),x=(()=>{let e;return K&&(e=i.get(K.id),e&&e.enabled)||(T&&(e=F(b,s=>s.enabled&&s.checked)),g.isUndefined(e)&&(e=F(b,s=>s.enabled))),e})(),Y=e=>{const s=y.has(e.id);e.origin.loading||(s?C(d=>{d.splice(d.findIndex(n=>n===e.id),1)}):(D.current.expands.has(e.id)||(D.current.expands.add(e.id),m==null||m(e.id,e.origin)),C(d=>{d.push(e.id)})))},R=e=>{if(a){const s=e.changeStatus(e.checked?"UNCHECKED":"CHECKED",r);M(Array.from(s.keys()))}else(e.isLeaf||!E)&&M(e.id)};return X(de(oe,{...l,ref:u,tabIndex:l.tabIndex??(A?-1:0),onKeyDown:e=>{var d;(d=l.onKeyDown)==null||d.call(l,e);const s=n=>{if(u.current){const t=u.current(n);if(t&&(L(t),!w&&!n.includes("level"))){const H=document.getElementById(I(t.id));H&&u.current(H)}}};switch(e.code){case"ArrowUp":e.preventDefault(),s("prev");break;case"ArrowDown":e.preventDefault(),s("next");break;case"ArrowLeft":e.preventDefault(),s("prev-level");break;case"ArrowRight":e.preventDefault(),s("next-level");break;case"Home":e.preventDefault(),s("first");break;case"End":e.preventDefault(),s("last");break;case"Enter":case"Space":e.preventDefault(),x&&R(x);break}},namespace:v,styled:O,list:b,itemId:I,itemSelected:!a&&T?i.get(r):void 0,itemFocused:x,expands:y,customItem:q,showLine:B,multiple:a,onlyLeafSelectable:E,disabled:A,virtual:w,focusVisible:Q,onNodeFocus:L,onNodeExpand:Y,onNodeClick:R,onScrollBottom:J}))}export{pe as T};
