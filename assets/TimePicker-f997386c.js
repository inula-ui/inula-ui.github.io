import{o as c,u as ze,a as Me,b as $e,f as Fe,y as Oe,G as Be,r as Ue,g as Le,d as se,l as y,V as N,A as je,M as He,i as We,N as Ge,k as Ye,n as qe,p as Y,P as Je,e as O,F as oe,m as q,j as n,I as J,Q as Ke,q as Qe,U as K,B as Ze,R as Xe,W as ae}from"./index-27d4f0cf.js";import{u as le}from"./useForkRef-f5a11f75.js";import{u as et}from"./MdRoute-b25dbccc.js";import{S as tt}from"./cancel-ed30f420.js";import{d as it,S as rt,T as nt,a as ct}from"./utils-78e8e2f3.js";const st=B=>c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...B},c.createElement("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"})),ot={"time-picker":"^time-picker","time-picker.is-disabled":"is-disabled","time-picker--small":"^time-picker--small","time-picker--medium":"^time-picker--medium","time-picker--large":"^time-picker--large","time-picker__input":"^time-picker__input","time-picker__indicator":"^time-picker__indicator","time-picker__separator":"^time-picker__separator","time-picker__clear":"^time-picker__clear","time-picker__icon":"^time-picker__icon","time-picker-popup":"^time-picker-popup","time-picker__panel":"^time-picker__panel","time-picker__header":"^time-picker__header","time-picker__column":"^time-picker__column","time-picker__cell":"^time-picker__cell","time-picker__cell.is-active":"is-active","time-picker__cell.is-disabled":"is-disabled","time-picker__footer":"^time-picker__footer"},mt=c.forwardRef((B,ue)=>{const{styleOverrides:de,styleProvider:S,formControl:u,model:pe,defaultModel:me,visible:fe,defaultVisible:ve,placeholder:Q,range:p=!1,format:v="HH:mm:ss",order:ke="ascend",clearable:ge=!1,size:_e,disabled:he=!1,config:Z,escClosable:be=!0,inputRef:T,inputRender:U,onModelChange:xe,onVisibleChange:ye,onClear:L,afterVisibleChange:w,...o}=ze("TimePicker",B),j=Me(),m=$e(ot,{"time-picker":S==null?void 0:S["time-picker"],"time-picker-popup":S==null?void 0:S["time-picker-popup"]},de),P=Fe(),{t:I}=Oe(),H=Be(),Se=Ue(),{pageScrollRef:Te,contentResizeRef:we}=Le(),E=c.useRef(null),k=c.useRef(null),g=c.useRef(null),R=c.useRef(null),D=c.useRef(null),Ee=le(g,T==null?void 0:T[0]),Re=le(R,T==null?void 0:T[1]),s=c.useRef(null),r=c.useRef({latestFocused:"start",onceVisible:!1,focusAnother:!1,inputValue:[void 0,void 0],rangeDate:[null,null]}),X=e=>ct(e,ke),[l,V]=se(ve??!1,fe,ye),[_,ee]=et([!1,!1]);_[0]&&(r.current.latestFocused="start"),_[1]&&(r.current.latestFocused="end");const[A,z]=se(me??null,pe,xe,(e,t)=>it(e,t,v),u==null?void 0:u.control);let[h,b=null]=p?A??[null,null]:[A,null];p&&(y.isNull(A)?[h,b]=r.current.rangeDate:r.current.rangeDate=[null,null]);const M=[0,1].map(e=>_[e]&&!y.isUndefined(r.current.inputValue[e])?r.current.inputValue[e]:(()=>{const t=e===0?h:b;return y.isNull(t)?"":N(t).format(v)})()),W=e=>{const t=_.findIndex(i=>i);p?y.isNull(A)?(r.current.rangeDate[t]=e,r.current.rangeDate.every(i=>!y.isNull(i))&&(r.current.focusAnother=X(r.current.rangeDate),r.current.focusAnother&&r.current.rangeDate.reverse(),r.current.inputValue=[void 0,void 0],z(r.current.rangeDate))):(r.current.inputValue=[void 0,void 0],z(i=>{i[t]=e,r.current.focusAnother=X(i),r.current.focusAnother&&i.reverse()})):(r.current.inputValue=[void 0,void 0],z(e)),H()},[De=I("TimePicker",p?"Start time":"Select time"),Ve=I("TimePicker","End time")]=p?Q??[]:[Q],{size:Ae,disabled:$}=je({size:_e,disabled:he||(u==null?void 0:u.control.disabled)}),Ce=He(l),Ne=`calc(var(--${j}-zindex-fixed) + ${Ce})`,G=c.useRef(),f=We(()=>{if(l&&E.current&&k.current){const e=k.current.offsetHeight,t=Xe.windowSize.width-ae*2,i=Math.min(k.current.scrollWidth,t),d=Ge(E.current,{width:i,height:e},{placement:"bottom-left",inWindow:ae});G.current=d.transformOrigin,P.classes.position&&k.current.classList.toggle(P.classes.position,!1),P.replaceRule("position",{top:d.top,left:d.left,maxWidth:t}),k.current.classList.toggle(P.classes.position,!0)}}),Pe=Ye(f,!l);qe(Te,"scroll",f,{passive:!0},!l||Pe),Y(E,f,void 0,!l),Y(k,f,void 0,!l),Y(we,f,void 0,!l),c.useImperativeHandle(ue,()=>({updatePosition:f}),[f]),c.useEffect(()=>{if(E.current&&D.current){let e=!1;const t=E.current.getBoundingClientRect();if(g.current&&document.activeElement===g.current){const i=g.current.getBoundingClientRect();D.current.style.cssText=`left:${i.left-t.left}px;width:${i.width}px;opacity:1;`,e=!0}if(R.current&&document.activeElement===R.current){const i=R.current.getBoundingClientRect();D.current.style.cssText=`left:${i.left-t.left}px;width:${i.width}px;opacity:1;`,e=!0}e||(D.current.style.cssText+="opacity:0;")}}),c.useEffect(()=>{if(r.current.focusAnother&&document.activeElement){const e=document.activeElement.parentElement;for(let t=0;t<e.childElementCount;t++){const i=e.children.item(t);if(i.tagName.toLowerCase()==="input"&&i!==document.activeElement){i.focus({preventScroll:!0});break}}}r.current.focusAnother=!1});const te=e=>{var t;if(p){const i=_.findIndex(d=>d);y.isNull(i===0?b:h)?(r.current.focusAnother=!0,H()):V(!1)}else V(!1);r.current.focusAnother||(t=s.current)==null||t.call(s,e)},ie=ge&&!y.isNull(A)&&!l&&!$,re=e=>{const t=e?0:1,i=e?h:b,d=U==null?void 0:U[t],ne=n("input",{...m("time-picker__input"),...u==null?void 0:u.inputAria,ref:e?Ee:Re,type:"text",autoComplete:"off",value:M[t],size:10,placeholder:e?De:Ve,disabled:$,onChange:a=>{var x;if(H(),r.current.inputValue[t]=a.currentTarget.value,N(a.currentTarget.value,v,!0).isValid()){const C=N(a.currentTarget.value,v).toDate();W(C),(x=s.current)==null||x.call(s,C)}},onKeyDown:a=>{if(a.code==="Escape")l&&be&&(a.stopPropagation(),a.preventDefault(),V(!1));else if(a.code==="Enter"&&M[t]&&N(M[t],v,!0).isValid()){a.preventDefault();const x=N(M[t],v).toDate();te(x)}},onFocus:()=>{var a,x,C;(x=(a=r.current).clearTid)==null||x.call(a),ee(ce=>{ce.fill(!1),ce[e?0:1]=!0}),r.current.inputValue=[void 0,void 0],l&&p&&i&&((C=s.current)==null||C.call(s,i))},onBlur:()=>{r.current.clearTid=Se.setTimeout(()=>{ee([!1,!1]),V(!1)},20)}});return d?d(ne):ne},F=e=>{(document.activeElement===g.current||document.activeElement===R.current)&&e.target!==g.current&&e.target!==R.current&&e.button===0&&e.preventDefault()},Ie=Je({compose:{disabled:$},form:u});return O(oe,{children:[O("div",{...o,...q(m("time-picker",`time-picker--${Ae}`,{"time-picker.is-disabled":$}),{className:o.className,style:o.style}),...Ie,ref:E,onMouseDown:e=>{var t;(t=o.onMouseDown)==null||t.call(o,e),F(e)},onMouseUp:e=>{var t;(t=o.onMouseUp)==null||t.call(o,e),F(e)},onClick:e=>{var t,i;(t=o.onClick)==null||t.call(o,e),_.some(d=>d)||(i=g.current)==null||i.focus({preventScroll:!0}),V(!0)},children:[re(!0),p&&O(oe,{children:[n("div",{...m("time-picker__indicator"),ref:D}),n("div",{...m("time-picker__separator"),children:n(J,{children:n(rt,{})})}),re(!1)]}),ie&&n("div",{...m("time-picker__clear"),role:"button","aria-label":I("Clear"),onClick:e=>{e.stopPropagation(),r.current.inputValue=[void 0,void 0],z(null),L==null||L()},children:n(J,{children:n(tt,{})})}),n("div",{...q(m("time-picker__icon"),{style:{visibility:ie?"hidden":void 0}}),children:n(J,{children:n(st,{})})})]}),n(Ke,{selector:()=>{let e=document.getElementById(`${j}-time-picker-root`);return e||(e=document.createElement("div"),e.id=`${j}-time-picker-root`,document.body.appendChild(e)),e},children:n(Qe,{enter:l,during:K,afterRender:()=>{f();const e=()=>{var i;const t=_[0]?h:b;t&&((i=s.current)==null||i.call(s,t))};p?e():r.current.onceVisible||(r.current.onceVisible=!0,e())},afterEnter:()=>{w==null||w(!0)},afterLeave:()=>{w==null||w(!1)},children:e=>{let t={};switch(e){case"enter":t={transform:"scaleY(0.7)",opacity:0};break;case"entering":t={transition:["transform","opacity"].map(i=>`${i} ${K}ms ease-out`).join(", "),transformOrigin:G.current};break;case"leaving":t={transform:"scaleY(0.7)",opacity:0,transition:["transform","opacity"].map(i=>`${i} ${K}ms ease-in`).join(", "),transformOrigin:G.current};break;case"leaved":t={display:"none"};break}return O("div",{...q(m("time-picker-popup"),{style:{zIndex:Ne,...t}}),ref:k,onMouseDown:i=>{F(i)},onMouseUp:i=>{F(i)},children:[n(nt,{ref:s,styled:m,time:r.current.latestFocused==="start"?h:b,format:v,config:Z?(...i)=>Z(...i,r.current.latestFocused,[h,b]):void 0,onTimeChange:i=>{W(i)}}),n("div",{...m("time-picker__footer"),children:n(Ze,{pattern:"link",onClick:()=>{const i=new Date;W(i),te(i)},children:I("TimePicker","Now")})})]})}})})]})});export{mt as T};
