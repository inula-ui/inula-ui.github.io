import{e as a,u as $,b as j,y as J,l as D,j as e,m as E,I as C,f as R,F as z,v as te,C as ue,T,q as he,d as ve,ab as ge,k as be}from"./index-9f212341.js";import{u as fe}from"./useForkRef-2e2abe46.js";import{F as we}from"./file_download-5b04ac0d.js";import{S as Ue}from"./add-10a33810.js";import{S as ye}from"./visibility-a3b46fdc.js";import{u as ie}from"./MdRoute-defb4432.js";import{u as xe}from"./getOffsetToRoot-777526f4.js";import{P as oe}from"./Progress-313fc97b.js";function ae(){const r=a.useRef(!1);return xe(()=>{r.current=!0}),r}function Se(r,y){const n=document.createElement("a");document.body.appendChild(n),n.style.display="none",n.href=r,n.download=y,n.click(),document.body.removeChild(n)}const ke=r=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...r},a.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5-1-1h-5l-1 1H5v2h14V4h-3.5z"})),Re={upload:"^upload"},Ee={"upload-button":"^upload-button","upload-button.is-disabled":"is-disabled","upload-button--load":"^upload-button--load","upload-button--error":"^upload-button--error","upload-button--progress":"^upload-button--progress","upload-button__thumbnail":"^upload-button__thumbnail","upload-button__name":"^upload-button__name","upload-button__actions":"^upload-button__actions","upload-button__icon":"^upload-button__icon","upload-button__text":"^upload-button__text"},ce={"upload-action":"^upload-action","upload-action.is-disabled":"is-disabled","upload-action--light":"^upload-action--light","upload-action--preview":"^upload-action--preview"},Ce={"upload-list":"^upload-list","upload-list__item":"^upload-list__item","upload-list__item--load":"^upload-list__item--load","upload-list__item--error":"^upload-list__item--error","upload-list__item--progress":"^upload-list__item--progress","upload-list__icon":"^upload-list__icon","upload-list__link":"^upload-list__link","upload-list__link.is-active":"is-active","upload-list__actions":"^upload-list__actions","upload-list__progress-wrapper":"^upload-list__progress-wrapper"},Le={"upload-picture":"^upload-picture","upload-picture__row":"^upload-picture__row","upload-picture__item":"^upload-picture__item","upload-picture__item.is-disabled":"is-disabled","upload-picture__item--load":"^upload-picture__item--load","upload-picture__item--error":"^upload-picture__item--error","upload-picture__item--progress":"^upload-picture__item--progress","upload-picture__thumbnail":"^upload-picture__thumbnail","upload-picture__name":"^upload-picture__name","upload-picture__actions":"^upload-picture__actions","upload-picture__progress-text":"^upload-picture__progress-text"},Ie={"upload-picture-list":"^upload-picture-list","upload-picture-list__item":"^upload-picture-list__item","upload-picture-list__item--load":"^upload-picture-list__item--load","upload-picture-list__item--error":"^upload-picture-list__item--error","upload-picture-list__item--progress":"^upload-picture-list__item--progress","upload-picture-list__thumbnail":"^upload-picture-list__thumbnail","upload-picture-list__thumbnail-img":"^upload-picture-list__thumbnail-img","upload-picture-list__link":"^upload-picture-list__link","upload-picture-list__link.is-active":"is-active","upload-picture-list__actions":"^upload-picture-list__actions","upload-picture-list__progress-wrapper":"^upload-picture-list__progress-wrapper"},K=a.createContext({files:[],onRemove:()=>{}}),B=a.forwardRef((r,y)=>{const{styleOverrides:n,styleProvider:_,children:o,preset:u,disabled:s=!1,_file:c,_defaultActions:b,_light:f,_onRemove:m,...l}=$("UploadAction",r),t=j(ce,{"upload-action":_==null?void 0:_["upload-action"]},n),{t:d}=J(),i=u==="download"?s||D.isUndefined(c.url):s;return e("div",{...l,...E(t("upload-action",{"upload-action.is-disabled":i,"upload-action--light":f}),{className:l.className,style:l.style}),ref:y,role:l.role??"button",tabIndex:l.tabIndex??(i?-1:0),title:l.title??u==="download"?d("Upload","Download file"):u==="remove"?d("Upload","Remove file"):void 0,onClick:v=>{var w;(w=l.onClick)==null||w.call(l,v),v.stopPropagation(),u==="download"?b!=null&&b.download?b.download(c):Se(c.url,c.name):u==="remove"&&(m==null||m())},children:o??(u==="download"?e(C,{children:e(we,{})}):u==="remove"?e(C,{children:e(ke,{})}):null)})}),se=r=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...r},a.createElement("path",{d:"M13 4H6v16h12V9h-5z",opacity:.3}),a.createElement("path",{d:"m20 8-6-6H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm-2 12H6V4h7v5h5v11z"})),le=a.forwardRef((r,y)=>{const{styleOverrides:n,styleProvider:_,children:o,disabled:u=!1,_file:s,_defaultActions:c,_light:b,_onRemove:f,...m}=$("UploadPreviewAction",r),l=j(ce,{"upload-action":_==null?void 0:_["upload-action"]},n),{t}=J();return e("a",{...m,...E(l("upload-action","upload-action--preview",{"upload-action.is-disabled":u||D.isUndefined(s.url),"upload-action--light":b}),{className:m.className,style:m.style}),ref:y,href:s.url,target:m.target??"_blank",title:m.title??t("Upload","Preview file"),onClick:d=>{var i;(i=m.onClick)==null||i.call(m,d),d.stopPropagation(),c!=null&&c.preview&&(d.preventDefault(),c.preview(s))},children:o??e(C,{children:e(ye,{})})})}),Te=a.forwardRef((r,y)=>{const{styleOverrides:n,styleProvider:_,file:o,actions:u,defaultActions:s,onRemove:c,...b}=$("UploadButton",r),f=j(Ee,{"upload-button":_==null?void 0:_["upload-button"]},n),{t:m}=J(),l=o&&o.state==="progress";return e("div",{...b,...E(f("upload-button",{"upload-button.is-disabled":l,[`upload-button--${o==null?void 0:o.state}`]:o}),{className:b.className,style:b.style}),ref:y,tabIndex:b.tabIndex??(l?-1:0),children:o&&o.state!=="progress"?R(z,{children:[o.thumbUrl?e("img",{...f("upload-button__thumbnail"),src:o.thumbUrl,alt:o.name}):R(z,{children:[e(C,{theme:o.state==="error"?"danger":"primary",children:e(se,{})}),e("div",{...f("upload-button__name"),children:o.name})]}),e("div",{...f("upload-button__actions"),children:a.Children.map(u??[e(le,{}),e(B,{preset:"remove"})],t=>a.cloneElement(t,{_file:o,_defaultActions:s,_light:!0,_onRemove:c}))})]}):R(z,{children:[e("div",{...f("upload-button__icon"),children:e(C,{children:l?e(te,{}):e(Ue,{})})}),e("div",{...f("upload-button__text"),children:m("Upload",l?"Uploading":"Upload")})]})})}),De=r=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...r},a.createElement("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5a2.5 2.5 0 0 1 5 0v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5a2.5 2.5 0 0 0 5 0V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"}));function Ae(r){const{styleOverrides:y,styleProvider:n,actions:_,defaultActions:o,...u}=$("UploadList",r),s=j(Ce,{"upload-list":n==null?void 0:n["upload-list"]},y),{files:c,onRemove:b}=a.useContext(K),f=ae(),[m,l]=ie([]);return e("ul",{...u,...E(s("upload-list"),{className:u.className,style:u.style}),children:c.map((t,d)=>e(ue,{originalSize:{height:"auto"},collapsedSize:{height:0},enter:!m.includes(t.uid),during:T,styles:{entering:{transition:["height","padding","margin"].map(i=>`${i} ${T}ms ease-out`).join(", ")},leaving:{transition:["height","padding","margin"].map(i=>`${i} ${T}ms ease-in`).join(", ")},leaved:{display:"none"}},skipFirstTransition:!f.current,afterLeave:()=>{l(i=>{i.splice(i.findIndex(v=>v===t.uid),1)}),b(t)},children:(i,v)=>R("li",{...E(s("upload-list__item",{[`upload-list__item--${t.state}`]:t.state}),{style:v}),ref:i,children:[e("div",{...s("upload-list__icon"),children:t.state==="progress"?e(C,{children:e(te,{})}):e(C,{rotate:45,children:e(De,{})})}),e("a",{...s("upload-list__link",{"upload-list__link.is-active":t.state==="load"&&!D.isUndefined(t.url)}),href:t.url,target:"_blank",rel:"noreferrer",title:t.name,onClick:w=>{o&&o.preview&&(w.preventDefault(),o.preview(t))},children:t.name}),e("div",{...s("upload-list__actions"),children:a.Children.map(_?_(t,d):[e(B,{preset:"remove"})],w=>a.cloneElement(w,{_file:t,_defaultActions:o,_onRemove:()=>{l(x=>{x.push(t.uid)})}}))}),e("div",{...s("upload-list__progress-wrapper"),children:D.isNumber(t.percent)&&e(oe,{percent:t.percent,label:!1,lineWidth:2})})]})},t.uid))})}function Ne(r){const{children:y,styleOverrides:n,styleProvider:_,actions:o,defaultActions:u,...s}=$("UploadPicture",r),c=j(Le,{"upload-picture":_==null?void 0:_["upload-picture"]},n),{t:b}=J(),{files:f,onRemove:m}=a.useContext(K),l=ae(),[t,d]=ie([]);return e("ul",{...s,...E(c("upload-picture"),{className:s.className,style:s.style}),children:R("div",{...c("upload-picture__row"),children:[f.map((i,v)=>e(he,{enter:!t.includes(i.uid),during:T,skipFirstTransition:!l.current,afterLeave:()=>{d(w=>{w.splice(w.findIndex(x=>x===i.uid),1)}),m(i)},children:w=>{let x={};switch(w){case"enter":x={transform:"scale(0)"};break;case"entering":x={transition:["transform"].map(A=>`${A} ${T}ms ease-out`).join(", "),transformOrigin:"top left"};break;case"leaving":x={transform:"scale(0)",transition:["transform"].map(A=>`${A} ${T}ms ease-in`).join(", "),transformOrigin:"top left"};break;case"leaved":x={display:"none"};break}return e("div",{children:e("li",{...E(c("upload-picture__item",{[`upload-picture__item--${i.state}`]:i.state,"upload-picture__item.is-disabled":i&&i.state==="progress"}),{style:x}),children:i.state!=="progress"?R(z,{children:[i.thumbUrl?e("img",{...c("upload-picture__thumbnail"),src:i.thumbUrl,alt:i.name}):R(z,{children:[e(C,{size:28,theme:i.state==="error"?"danger":"primary",children:e(se,{})}),e("div",{...c("upload-picture__name"),children:i.name})]}),e("div",{...c("upload-picture__actions"),children:a.Children.map(o?o(i,v):[e(le,{}),e(B,{preset:"remove"})],A=>a.cloneElement(A,{_file:i,_defaultActions:u,_light:!0,_onRemove:()=>{d(q=>{q.push(i.uid)})}}))})]}):R(z,{children:[e("div",{...c("upload-picture__progress-text"),children:b("Upload","Uploading")}),D.isNumber(i.percent)&&e(oe,{style:{width:"100%"},percent:i.percent,label:!1,lineWidth:2})]})})})}},i.uid)),e("div",{children:y})]})})}function Oe(r){const{styleOverrides:y,styleProvider:n,actions:_,defaultActions:o,...u}=$("UploadPictureList",r),s=j(Ie,{"upload-picture-list":n==null?void 0:n["upload-picture-list"]},y),{files:c,onRemove:b}=a.useContext(K),f=ae(),[m,l]=ie([]);return e("ul",{...u,...E(s("upload-picture-list"),{className:u.className,style:u.style}),children:c.map((t,d)=>e(ue,{originalSize:{height:"auto"},collapsedSize:{height:0},enter:!m.includes(t.uid),during:T,styles:{entering:{transition:["height","padding","margin"].map(i=>`${i} ${T}ms ease-out`).join(", ")},leaving:{transition:["height","padding","margin"].map(i=>`${i} ${T}ms ease-in`).join(", ")},leaved:{display:"none"}},skipFirstTransition:!f.current,afterLeave:()=>{l(i=>{i.splice(i.findIndex(v=>v===t.uid),1)}),b(t)},children:(i,v)=>R("li",{...E(s("upload-picture-list__item",{[`upload-picture-list__item--${t.state}`]:t.state}),{style:v}),ref:i,children:[e("div",{...s("upload-picture-list__thumbnail"),children:t.state==="progress"?e(C,{size:28,children:e(te,{})}):t.thumbUrl?e("img",{...s("upload-picture-list__thumbnail-img"),src:t.thumbUrl,alt:t.name}):e(C,{size:28,theme:t.state==="error"?"danger":"primary",children:e(se,{})})}),e("a",{...s("upload-picture-list__link",{"upload-picture-list__link.is-active":t.state==="load"&&!D.isUndefined(t.url)}),href:t.url,target:"_blank",rel:"noreferrer",title:t.name,onClick:w=>{o&&o.preview&&(w.preventDefault(),o.preview(t))},children:t.name}),e("div",{...s("upload-picture-list__actions"),children:a.Children.map(_?_(t,d):[e(B,{preset:"remove"})],w=>a.cloneElement(w,{_file:t,_defaultActions:o,_onRemove:()=>{l(x=>{x.push(t.uid)})}}))}),e("div",{...s("upload-picture-list__progress-wrapper"),children:D.isNumber(t.percent)&&e(oe,{percent:t.percent,label:!1,lineWidth:2})})]})},t.uid))})}function Fe(r,y){const{children:n,styleOverrides:_,styleProvider:o,formControl:u,model:s,defaultModel:c,request:b,max:f,drag:m=!1,customUpload:l,beforeUpload:t,onModelChange:d,onRemove:i,...v}=$("Upload",r),w=j(Re,{upload:o==null?void 0:o.upload,"upload-list":o==null?void 0:o["upload-list"]},_),x=a.useRef(null),A=fe(x,y),q=a.useRef({fileURLs:[]}),[M,W]=ve(c??[],s,void 0,void 0,u==null?void 0:u.control);ge(()=>{q.current.fileURLs.forEach(g=>{URL.revokeObjectURL(g)})});const re=g=>{if(l)l(g);else{let L=Date.now();const p=[];for(let U=0;U<g.length;U++){const h=g.item(U);if(h){const S=new XMLHttpRequest;let N=++L;const pe=I=>{const O=URL.createObjectURL(h);q.current.fileURLs.push(O);const k={uid:N,name:h.name,url:O,thumbUrl:h.type.startsWith("image")?O:void 0,originFile:h,response:S.response,...I};if(D.isNumber(f)&&M.length+p.length>=f){if(f===1){N=k.uid=M[0].uid,W([k]),d==null||d([k],{type:"update",files:[k]});return}return!0}p.push(k)},Q=I=>{let O=!0;const k=W(F=>{const H=F.findIndex(Z=>Z.uid===N);H!==-1?F[H]=Object.assign(F[H],{response:S.response,...I}):O=!1});O&&(d==null||d(k,{type:"update",files:[k.find(F=>F.uid===N)]}))},Y=I=>{if(I===!1)pe({state:null});else{if(pe({state:"progress",percent:0}))return;S.upload.addEventListener("progress",P=>{if(P.lengthComputable){const X=Math.round(P.loaded*100/P.total);Q({state:"progress",percent:X})}}),S.addEventListener("error",()=>{Q({state:"error",percent:void 0})}),S.addEventListener("load",()=>{Q({state:S.status>=200&&S.status<300?"load":"error",percent:void 0})});const{url:k,method:F="POST",responseType:H="json",header:Z={},body:me=P=>{const X=new FormData;return X.append("file",P),X},custom:ee}=b;S.open(F,k),S.responseType=H,Object.entries(Z).forEach(P=>{S.setRequestHeader(...P)}),ee==null||ee(S),S.send(me(I===!0?h:I))}};let G=!0;t?(G=t(h,g),G instanceof Promise?G.then(I=>{Y(I)}):Y(G)):Y(!0)}}if(p.length>0){const U=W(h=>h.concat(p));d==null||d(U,{type:"add",files:p})}}},ne=g=>{let L={};return m&&(L={onDragEnter:p=>{var U,h;(h=(U=g.props).onDragEnter)==null||h.call(U,p),p.stopPropagation(),p.preventDefault()},onDragOver:p=>{var U,h;(h=(U=g.props).onDragOver)==null||h.call(U,p),p.stopPropagation(),p.preventDefault()},onDrop:p=>{var S,N;(N=(S=g.props).onDrop)==null||N.call(S,p),p.stopPropagation(),p.preventDefault();const h=p.dataTransfer.files;re(h)}}),a.cloneElement(g,{...L,onClick:p=>{var U,h;(h=(U=g.props).onClick)==null||h.call(U,p),x.current&&x.current.click()}})},de=be(g=>{i==null||i(g);const L=W(p=>{const U=p.findIndex(h=>h.uid===g.uid);p.splice(U,1)});d==null||d(L,{type:"remove",files:[g]})}),_e=a.useMemo(()=>({files:M,onRemove:de}),[M,de]);return R(z,{children:[e(K.Provider,{value:_e,children:D.isFunction(n)?n(ne):ne(n)}),e("input",{...v,...E(w("upload"),{className:v.className,style:v.style}),ref:A,type:v.type??"file",onChange:g=>{var p;(p=v.onChange)==null||p.call(v,g);const L=g.currentTarget.files;L&&re(L),g.currentTarget.value=""}})]})}const V=a.forwardRef(Fe);V.Button=Te;V.Action=B;V.PreviewAction=le;V.List=Ae;V.Picture=Ne;V.PictureList=Oe;const Me=r=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...r},a.createElement("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zM7 9l1.41 1.41L11 7.83V16h2V7.83l2.59 2.58L17 9l-5-5-5 5z"}));export{Me as S,V as U};
